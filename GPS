#include "lpc214x.h" //COM3
#include "stdio.h"
#include "string.h"
#include "uart_f3.c"

void delay(unsigned int t)
{
for(int i=0; i<t; i++)
{for(int j=0; j<5000; j++);}
}

int main()
{
unsigned char temp;
Uart0init();
Uart1init();
// printf("GPS Program");
while(1)
{
while((Uart1_Getchar()) != '$');
while((Uart1_Getchar()) != 'R');
while((Uart1_Getchar()) != 'C');

Uart1_Getchar(); //','
//printf("Time: ");
do{
temp = Uart1_Getchar();
Uart0_Putchar(temp);
} while(temp != 0X2C);// till next comma
while((Uart1_Getchar()) != 'A');
while((Uart1_Getchar()) != 'N');
Uart1_Getchar(); //','
do{
temp = Uart1_Getchar();
Uart0_Putchar(temp);
} while(temp != 0X2C);

}
return 0;
}


//uart_f3.c
#include "lpc214x.h" 
unsigned char Uart0_Putchar(unsigned char ch)
{
if(ch=='\n')
{
while(!(U0LSR & 0X20));
U0THR=0X0D;
}
while(!(U0LSR & 0X20));
return(U0THR=ch);
}
//FOC
unsigned char Uart1_Getchar(void)
{
while(!(U1LSR &0X01));
  return(U1RBR);
  }
  void Uart0init()
  {
  PINSEL0 |=0X00000005;
  U0FCR=0X07;
  U0LCR=0X83;
  U0DLL=0X62;
  U0DLM=0X00;
  U0LCR=0X03;
  }
  
  void Uart1init()
  {
  PINSEL0 |=0X00050000;
  U1FCR=0X07;
  U1LCR=0X83;
  U1DLL=0X62;
  U1DLM=0X00;
  U1LCR=0X03;
  }

UART0
#include<lpc214x.h> 
void UART0Init()
{ PINSEL0 |=0x00000005; 
U0FCR=0x07; 
U0LCR=0x83; 
U0DLM=0x00; 
U0DLL=0x62; 
U0LCR=0x03; } 
unsigned char UART0_PutChar(unsigned char ch) 
{ if(ch=='\n')
{ while(!(U0LSR & 0x20)); 
U0THR=0x0D; } 
while(!(U0LSR & 0x20));
return(U0THR=ch); } 
unsigned char UART0_GetChar(void)
{ while(!(U0LSR & 0x01)); 
return(U0RBR); }
void UART0_Puts(unsigned char *str) 
{ while(1) 
{ if(*str=='\0') 
break; 
UART0_PutChar(*str++);
}
}
UART1
#include<lpc214x.h>
void UART1Init()
{ PINSEL0 |=0x00050000;
U1FCR=0x07; 
U1LCR=0x83;
U1DLM=0x00;
U1DLL=0x62;
U1LCR=0x03; 
} unsigned char UART1_PutChar(unsigned char ch)
{ if(ch=='\n') 
{ while(!(U1LSR & 0x20));
U1THR=0x0D; } 
while(!(U1LSR & 0x20));
return(U1THR=ch); }
unsigned char UART1_GetChar(void) 
{ while(!(U1LSR & 0x01)); 
return(U1RBR); } 
void UART1_Puts(unsigned char *str)
{ while(1) { if(*str=='\0') break; 
UART1_PutChar(*str++); } }
GPS :
#include<lpc214x.h> 
#include "UART0.c"
#include "UART1.c"
int main()
{ unsigned char temp;
UART0Init(); 
UART1Init(); 
while(1)
{ temp=UART1_GetChar();
UART0_PutChar(temp); }
return 0; }
